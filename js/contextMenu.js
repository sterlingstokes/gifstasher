"use strict";function preload(e){var t=[];for(var n=0;n<e.length;n++){t[n]=new Image;t[n].src=e[n].url}}function stashGif(e){var t=JSON.stringify(e.srcUrl),n=t.substring(t.lastIndexOf("/")+1),r=n.split(".").pop(),i,s;r=r.substring(0,r.length-1);if(r==="gif"||r==="jpg"){chrome.runtime.sendMessage({},function(){if(localStorage.getItem("gifs")){i=JSON.parse(localStorage.getItem("gifs"))}else{i=[]}t=t.substring(1);t=t.substring(0,t.length-1);var e={id:Date.now(),title:"Untitled",url:t,tags:[],isFavorite:false};i.push(e);var n=JSON.stringify(i);localStorage.setItem("gifs",n);s=webkitNotifications.createNotification("img/icon-small.png","Gif stashed!","Your gif has been saved to your Gif stash.");s.show();setTimeout(function(){s.cancel()},5e3)})}else{s=webkitNotifications.createNotification("img/icon-small-error.png","Oh noes!","There was an error stashing your gif. Are you sure that it's a gif?");s.show();setTimeout(function(){s.cancel()},15e3)}}if(localStorage.getItem("gifs")){var gifs=JSON.parse(localStorage.getItem("gifs"));preload(gifs)}chrome.contextMenus.create({title:"Stash this gif",contexts:["image"],onclick:stashGif})